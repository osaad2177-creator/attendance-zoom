<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Attendance System</title>
<style>
  body {
    margin:0; font-family:sans-serif; display:flex; justify-content:center; align-items:center; height:100vh; background:#f0f4f8;
  }
  .card { background:#fff; padding:2rem; border-radius:1rem; box-shadow:0 0 15px rgba(0,0,0,0.1); width:350px; }
  .field { margin-bottom:1rem; }
  input { width:100%; padding:0.7rem; border-radius:0.5rem; border:1px solid #ccc; }
  button { width:48%; padding:0.7rem; border:none; border-radius:0.5rem; cursor:pointer; margin-right:2%; }
  .check-in { background:#2563eb; color:#fff; }
  .check-out { background:#f1f5f9; color:#2563eb; }
  .message { margin-top:1rem; display:none; padding:0.5rem; border-radius:0.5rem; }
  .success { background:#d1fae5; color:#15803d; }
  .error { background:#fee2e2; color:#b91c1c; }
</style>
</head>
<body>

<div class="card">
  <h2>Attendance System</h2>
  <div class="field">
    <input type="text" id="employeeName" placeholder="Enter full name" />
  </div>
  <div class="field" style="display:flex; justify-content:space-between;">
    <button class="check-in">✅ Check In</button>
    <button class="check-out">❌ Check Out</button>
  </div>
  <div class="message" id="statusMessage"></div>
</div>

<script>
const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyNeWICu6QjixISJvqmCrjWgatbigewzKcCRXz4fSCL2X9RuibOaIAspLbmGy01LzZU-w/exec";
const nameInput = document.getElementById("employeeName");
const statusMessage = document.getElementById("statusMessage");

function setMessage(msg, type="success"){
  statusMessage.textContent = msg;
  statusMessage.className = `message ${type}`;
  statusMessage.style.display = "block";
}

async function sendAttendance(type){
  const name = nameInput.value.trim();
  if(!name){ setMessage("Please enter your name","error"); return; }

  try{
    // بدون location → نرسل القيمة الثابتة
    const url = new URL(APPS_SCRIPT_URL);
    url.searchParams.set("employee_name", name);
    url.searchParams.set("attendance_type", type);
    url.searchParams.set("latitude", "0");
    url.searchParams.set("longitude", "0");

    const res = await fetch(url.toString(), { method:"GET", cache:"no-store" });
    const text = await res.text();

    if(res.ok && text.includes("success")){
      setMessage(`${type} recorded successfully`,"success");
    } else {
      setMessage("Server error","error");
    }
  }catch{
    setMessage("Network error","error");
  }
}

document.querySelector(".check-in").addEventListener("click", ()=>sendAttendance("Check In"));
document.querySelector(".check-out").addEventListener("click", ()=>sendAttendance("Check Out"));
</script>

</body>
</html>
